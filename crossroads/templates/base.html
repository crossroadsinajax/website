{% load static wagtailuserbar %}

<!DOCTYPE html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8" />
        <title>
            {% block title %}
                {% if self.seo_title %}{{ self.seo_title }}{% else %}{{ self.title }}{% endif %}
            {% endblock %}
            {% block title_suffix %}
                {% with self.get_site.site_name as site_name %}
                    {% if site_name %}- {{ site_name }}{% endif %}
                {% endwith %}
            {% endblock %}
        </title>
        <meta name="description" content="" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        {# Global stylesheets #}
        <link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap-4.3.1.min.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/crossroads.css' %}">
        <link href='http://fonts.googleapis.com/css?family=Lato:400,700' rel='stylesheet' type='text/css'>
        <link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans|Poppins&display=swap" rel="stylesheet"> 
        <link href="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.6.1/css/bootstrap4-toggle.min.css" rel="stylesheet">
        {% block extra_css %}
            {# Override this in templates to add extra stylesheets #}
        {% endblock %}
    </head>

    <body class="{% block body_class %}{% endblock %}">
        {% wagtailuserbar %}

        <nav class="navbar navbar-expand-lg navbar-light static-top">
          <div class="container">
          <a class="navbar-brand" href="/">
            <img id="crossroads-logo" src="{% static 'img/crossroads.png' %}"></img>
          </a>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>

          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav ml-auto">
              <li class="nav-item active">
                <a class="nav-link" href="/services">Services<span class="sr-only">(current)</span></a>
              </li>
              <li class="nav-item dropdown active">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">About us</a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <!--
                  <a class="dropdown-item" href="/our-beliefs">Our beliefs</a>
                  <a class="dropdown-item" href="/sunday-gatherings">Sunday gatherings</a>
                  <a class="dropdown-item" href="/personal-stories">Personal stories</a>
                  -->
                </div>
              </li>
              <li class="nav-item dropdown active">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <!--
                  <a class="dropdown-item" href="#">Church calendar</a>
                  <a class="dropdown-item" href="#">Become a member</a>
                  <a class="dropdown-item" href="#">Become a Christian</a>
                  <a class="dropdown-item" href="#">Blog</a>
                  <a class="dropdown-item" href="#">Devotional reading</a>
                  -->
                </div>
              </li>
              <li class="nav-item dropdown active">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Connecting</a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <!--
                  <a class="dropdown-item" href="/prayer-requests">Prayer requests</a>
                  <a class="dropdown-item" href="#">Parents Supporting Parents</a>
                  <a class="dropdown-item" href="#">Children's programs</a>
                  <a class="dropdown-item" href="#">Gym night</a>
                  -->
                </div>
              </li>
              <li class="nav-item dropdown active">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Contact us</a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <!--
                  <a class="dropdown-item" href="#">Church office</a>
                  <a class="dropdown-item" href="#">Church directions</a>
                  -->
                </div>
              </li>
              {% if request.user.is_authenticated %}
              <li class="nav-item dropdown active">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">{{ request.user }}</a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="/profile">Profile</a>
                  <a class="dropdown-item" href="/logout">Log out<span class="sr-only">(current)</span></a>
                </div>
              </li>
              {% else %}
              <li class="nav-item active">
                  <a class="nav-link" href="/login">Log in<span class="sr-only">(current)</span></a>
              </li>
              {% endif %}
            </ul>
          </div>
          </div>
        </nav>

        {% block content %}
        {% endblock %}

        {# Global javascript #}
        <script type="text/javascript" src="{% static 'js/crossroads.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/jquery-3.3.1.slim.min.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/popper-1.14.7.min.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/bootstrap-4.3.1.min.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/universal-parallax.min.js' %}"></script>
        <script src="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.6.1/js/bootstrap4-toggle.min.js"></script>
        <script>
          new universalParallax().init();
          // $('[data-toggle="collapse"]').on('click', function() {
          //   // TODO: icon toggling
          // });

          // https://stackoverflow.com/a/42591519
          if (location.hash) {
            $('a[href=\'' + location.hash + '\']').tab('show');
          }
          var activeTab = localStorage.getItem('activeTab');
          if (activeTab) {
            $('a[href="' + activeTab + '"]').tab('show');
          }

          $('body').on('click', 'a[data-toggle=\'tab\']', function (e) {
            e.preventDefault()
            var tab_name = this.getAttribute('href')
            if (history.pushState) {
              history.pushState(null, null, tab_name)
            }
            else {
              location.hash = tab_name
            }
            localStorage.setItem('activeTab', tab_name)

            $(this).tab('show');
            return false;
          });
          $(window).on('popstate', function () {
            var anchor = location.hash ||
              $('a[data-toggle=\'tab\']').first().attr('href');
            $('a[href=\'' + anchor + '\']').tab('show');
          });
        </script>

        {% block extra_js %}
            {# Override this in templates to add extra javascript #}
        {% endblock %}
    </body>
</html>
